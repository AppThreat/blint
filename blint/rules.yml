- id: CHECK_NX
  title: Check Non-Executable Memory Protection
  description: |
    Most modern CPUs protect against executing non-executable memory regions (heap, stack, etc). This is known either as `Non-eXecute (NX) or eXecute-Disable (XD)`. This protection reduces the areas an attacker can use to perform arbitrary code execution.
    An operating system with support for the NX bit may mark certain areas of memory as non-executable. The processor will then refuse to execute any code residing in these areas of memory. The general technique, known as executable space protection, also called Write XOR Execute, is used to prevent certain types of malicious software from taking over computers by inserting their code into another program's data storage area and running their own code from within this section; one class of such attacks is known as the buffer overflow attack.
    Do not disable this protection. Check and remove the below gcc flags.

    ```bash
    gcc -fno-stack-protector -z execstack
    ```
  severity: critical
- id: CHECK_PIE
  title: Check Position-Independent Executable Protection
  description: |
    `Position-Independent Executable (PIE)` executes properly regardless of its absolute address. PIE binaries are used in some security-focused Linux distributions to allow PaX or Exec Shield to use address space layout randomization to prevent attackers from knowing where existing executable code is during a security attack using exploits that rely on knowing the offset of the executable code in the binary, such as return-to-libc attacks.
    Apple's macOS and iOS fully support PIE executables; a warning is issued when non-PIE iOS executables are submitted for approval to Apple's App Store.
    Android enabled support for PIEs in Jelly Bean and removed non-PIE linker support in Lollipop.
    For go binary builds, enable pie by specifying the buildmode=pie as described in the [documentation](https://pkg.go.dev/cmd/go#hdr-Build_modes). The below command line enables pie along with relro and other protections.

    ```bash
    go build -buildmode=pie -ldflags -extldflags=-Wl,-z,now,-z,relro
    ```
  severity: high
